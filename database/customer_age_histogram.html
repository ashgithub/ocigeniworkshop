<!--
  File: customer_age_histogram.html
  Purpose: Visualizes the customer distribution by age bucket from SH.CUSTOMERS as a bar chart.
  Documentation:
    - Chart.js: https://www.chartjs.org/docs/latest/
    - Oracle sample schema SH.CUSTOMERS: https://docs.oracle.com/en/database/oracle/oracle-database/23/dwhsg/sample-schema-customer-table.html

  Slack Channels: #oci-ai, #oracle-ai

  Environment:
    - No backend required; this file is static and can be opened in any browser.
    - Data was collected by running the following SQL using the workshop Oracle connection:

      SELECT
        CASE
          WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) < 10 THEN '0-9'
          WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 10 AND 19 THEN '10-19'
          WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 20 AND 29 THEN '20-29'
          WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 30 AND 39 THEN '30-39'
          WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 40 AND 49 THEN '40-49'
          WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 50 AND 59 THEN '50-59'
          WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 60 AND 69 THEN '60-69'
          WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 70 AND 79 THEN '70-79'
          WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 80 AND 89 THEN '80-89'
          ELSE '90+'
        END AS AGE_BUCKET, COUNT(*) AS NUM_CUSTOMERS
      FROM SH.CUSTOMERS
      GROUP BY
        CASE
            WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) < 10 THEN '0-9'
            WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 10 AND 19 THEN '10-19'
            WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 20 AND 29 THEN '20-29'
            WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 30 AND 39 THEN '30-39'
            WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 40 AND 49 THEN '40-49'
            WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 50 AND 59 THEN '50-59'
            WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 60 AND 69 THEN '60-69'
            WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 70 AND 79 THEN '70-79'
            WHEN (EXTRACT(YEAR FROM SYSDATE) - CUST_YEAR_OF_BIRTH) BETWEEN 80 AND 89 THEN '80-89'
            ELSE '90+'
        END
      ORDER BY MIN(CUST_YEAR_OF_BIRTH);

  How to run:
    1. Open this file directly in your web browser (double-click or drag/drop).
    2. The chart will display customer counts for each age bucket.
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Customers by Age Bucket (Oracle SH.CUSTOMERS)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; background: #f9f9f9; }
    h2 { color: #2D3F50; }
    .container { max-width: 700px; margin: auto; background: #fff; padding: 3em 2em; border-radius: 8px; box-shadow: 0 2px 12px #ddd; }
  </style>
</head>
<body>
<div class="container">
  <h2>Customer Count by Age Bucket</h2>
  <canvas id="customerAgeChart" width="600" height="300"></canvas>
  <p>
    Source: Oracle <code>SH.CUSTOMERS</code> sample schema.<br>
    Workshop: OCI AI Servicesâ€”Data Visualization Demo.
  </p>
</div>
<script>
  const ctx = document.getElementById('customerAgeChart').getContext('2d');
  const data = {
    labels: ["90+", "80-89", "70-79", "60-69", "50-59", "40-49", "30-39"], // oldest to youngest as per SQL output order
    datasets: [{
      label: 'Number of Customers',
      data: [3604, 9090, 14356, 10630, 9373, 7845, 602],
      backgroundColor: [
        'rgba(94,53,177,0.7)',
        'rgba(41,121,255,0.7)',
        'rgba(0,184,212,0.7)',
        'rgba(67,160,71,0.7)',
        'rgba(255,202,40,0.7)',
        'rgba(239,83,80,0.7)',
        'rgba(171,71,188,0.7)'
      ],
      borderWidth: 1
    }]
  };
  const config = {
    type: 'bar',
    data: data,
    options: {
      scales: {
        x: { title: { display: true, text: 'Age Bucket' } },
        y: { title: { display: true, text: 'Number of Customers' }, beginAtZero: true }
      },
      plugins: {
        legend: { display: false },
        tooltip: { enabled: true, callbacks: { label: ctx => `Count: ${ctx.parsed.y}` } }
      }
    }
  };
  new Chart(ctx, config);
</script>
</body>
</html>
